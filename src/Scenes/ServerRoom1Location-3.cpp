#include "ServerRoom1Location-3.h"
#include "Game.h"
#include <iostream>
using namespace std;

void ServerRoom1Location::run() {
    cout <<
         "Вы входите в серверную. Воздух застыл, свет мерцает, всё выглядит оставленным.\n";

    // --- ВЫБОР 1 ---
    cout <<
         "\n1) Включить терминал\n"
         "2) Не трогать терминал\n"
         "Ваш выбор:\n";

    int terminalChoice = ask({1,2});

    if (terminalChoice == 1) {
        usedTerminal = true;
        cout <<
             "\nТерминал оживает. На экране быстро появляется диагностика...\n\n"
             "Состояние станции:\n"
             "- Связь: норма\n"
             "- Повреждения: нет\n"
             "- Активность персонала: в пределах нормы\n"
             "- Внутренняя секция: ПЕРЕГРЕВ\n\n"
             "Но всё это не сходится. По данным — обычный день.\n"
             "А станция молчит уже давно.\n"
             "Логи будто застыли и не знают, что случилось после.\n";
    } else {
        cout <<
             "\nВы оставляете терминал выключенным. Комната остаётся такой же немой и пустой.\n";
    }

    // --- ВЫБОР 2 ---
    cout <<
         "\n1) Осмотреть стойки\n"
         "Ваш выбор: ";

    int rackChoice = ask({1});
// todo добавить еще один предмет, который был бы так же полезен, как и модуль
    cout <<
         "\nВ стойках попадаются разрозненные детали:\n"
         "- Охлаждающий модуль\n"
         "- Повреждённый дисплей\n"
         "- Старая клавиатура\n";

    if (usedTerminal) {
        cout <<
             "\nТерминал намекал: перегрев. Охлаждающий модуль мог бы пригодиться.\n";
    }

    // --- ВЫБОР 3 ---
    cout <<
         "\nЧто взять?\n"
         "1) Охлаждающий модуль\n"
         "2) Повреждённый дисплей\n"
         "3) Клавиатура\n"
         "4) Оставить всё\n"
         "Ваш выбор: ";

    int itemChoice = ask({1,2,3,4});

    switch (itemChoice) {
        case 1:
            foundCoolingModule = true;
            cout << "Вы берёте охлаждающий модуль.\n";
            break;
        case 2:
            cout << "Вы берёте повреждённый дисплей.\n";
            break;
        case 3:
            cout << "Вы берёте клавиатуру.\n";
            break;
        case 4:
            cout << "Вы ничего не берёте.\n";
            break;
    }

    // --- ВЫБОР 4 ---
    cout <<
         "\nПеред вами дверь с сенсорным замком.\n"
         "Можно вскрыть её быстро, но это риск.\n"
         "\n1) Открыть быстро\n"
         "2) Найти код на серверах\n"
         "Ваш выбор: ";

    int doorChoice = ask({1,2});

    if (doorChoice == 1) {
        cout <<
             "\nВы решаетесь на быстрый взлом...\n"
             "Искра — стойки гаснут. Произошло короткое замыкание.\n"
             "Доступ к исследовательскому диску потерян.\n";
        game.currentLocation = &game.fuelCompartment1Location;
        return;
    }

    cout <<
         "\nВы ищете рабочий блок...\n"
         "Один сервер отвечает, и вы находите нужный код.\n"
         "Дверь плавно открывается.\n";

    game.currentLocation = &game.serverRoom2Location;
}
